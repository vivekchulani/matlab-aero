function [aol_theta, aol_theta_M] = Fig_aol_theta(SweepC4, A, Taper, M, TC)
%[aol_theta, aol_theta_M] = Fig_aol_theta(SweepC4, A, Taper, M, TC)
%Change of zero-lift-angle (aoL) due to twist (theta), Datcom 
%Figure 4.1.3.1.4 including Mach effects, Datcom Figure 4.1.3.1.6
%Input
%SweepLE = Leading edge sweep
%A = Aspect Ratio
%TR = Taper ratio
%M = Subsonic Mach number
%TC = Wing section Thickness to chord ratio (in percent)
%Output
%aol_theta = Change in zero-lift-angle (aol) due to twist (theta)
%aol_theta_M = Correction for compressibility effects (Mach)

%Datcom Figure 4.1.3.1.4-A, B and C
%Taper Ratio
    X3 = [0.0 ,0.5, 1.0];
%Aspect Ratio
    X2 = [6.0, 3.5, 1.5];
%c/4 Sweep
    X = [-45., -40., -35., -30., -25., -20., -15., ...
         -10.,  -5.,   0.,   5.,  10.,  15.,  20., ...
          25.,  30.,  35.,  40.,  45.,  50.,  55., ...
          60.];
%daol_theta
    Y = {{[-0.4000,-0.4000,-0.4000,-0.4000,-0.4000,-0.4000,-0.4000, ...
           -0.4000,-0.4000,-0.4000,-0.3990,-0.3980,-0.3970,-0.3960, ...
           -0.3950,-0.3940,-0.3930,-0.3902,-0.3880,-0.3850,-0.3790, ...
           -0.3730]
          [-0.3820,-0.3820,-0.3820,-0.3820,-0.3820,-0.3820,-0.3820, ...
           -0.3820,-0.3820,-0.3820,-0.3790,-0.3770,-0.3740,-0.3720, ...
           -0.3680,-0.3660,-0.3640,-0.3600,-0.3560,-0.3500,-0.3430, ...
           -0.3350]
          [-0.3670,-0.3670,-0.3670,-0.3670,-0.3670,-0.3670,-0.3670, ...
           -0.3670,-0.3670,-0.3670,-0.3640,-0.3610,-0.3580,-0.3550, ...
           -0.3510,-0.3470,-0.3430,-0.3390,-0.3360,-0.3310,-0.3260, ...
           -0.3180]};
      
         {[-0.4120,-0.4120,-0.4120,-0.4102,-0.4120,-0.4120,-0.4120, ...
           -0.4120,-0.4120,-0.4120,-0.4110,-0.4080,-0.4070,-0.4050, ...
           -0.4020,-0.3995,-0.3980,-0.3950,-0.3930,-0.3895,-0.3860, ...
           -0.3800]
          [-0.4100,-0.4100,-0.4100,-0.4100,-0.4100,-0.4100,-0.4100, ...
           -0.4100,-0.4100,-0.4100,-0.4080,-0.4060,-0.4030,-0.4010, ...
           -0.3980,-0.3960,-0.3940,-0.3920,-0.3880,-0.3850,-0.3805, ...
           -0.3760]
          [-0.4080,-0.4080,-0.4080,-0.4080,-0.4080,-0.4080,-0.4080, ...
           -0.4080,-0.4080,-0.4080,-0.4070,-0.4060,-0.4060,-0.4050, ...
           -0.4040,-0.4030,-0.4020,-0.4000,-0.3980,-0.3960,-0.3930, ...
           -0.3880]};

         {[-0.4280,-0.4280,-0.4280,-0.4282,-0.4280,-0.4280,-0.4280, ...
           -0.4280,-0.4280,-0.4280,-0.4270,-0.4250,-0.4240,-0.4230, ...
           -0.4210,-0.4195,-0.4185,-0.4170,-0.4175,-0.4170,-0.4175, ...
           -0.4180]
          [-0.4180,-0.4180,-0.4180,-0.4180,-0.4180,-0.4180,-0.4180, ...
           -0.4180,-0.4180,-0.4180,-0.4170,-0.4160,-0.4150,-0.4140, ...
           -0.4125,-0.4105,-0.4095,-0.4085,-0.4075,-0.4165,-0.4160, ...
           -0.4150]
          [-0.4080,-0.4080,-0.4080,-0.4080,-0.4080,-0.4080,-0.4080, ...
           -0.4080,-0.4080,-0.4080,-0.4085,-0.4090,-0.4095,-0.4095, ...
           -0.4090,-0.4820,-0.4070,-0.4060,-0.4040,-0.4000,-0.3960, ...
           -0.3900]}};
        
    %perform interpolation
    nmY = length(X3);
    nmX2 = length(X2);
    Y1 = cell(size(nmY));
    Y2 = zeros(size(nmX2));
    
    for i=1:nmY
        for j=1:nmX2
            %interpolate by sweep for each graph under each aspect ratio
            %and taper ratio
            Y1{i}(j) = interp1(X,Y{i}{j},SweepC4,'spline','extrap');
        end % end sweep
        %interpolate by aspect ratio for each graph under taper ratio
        Y2(i) = interp1(X2,Y1{i},A,'linear','extrap');
    end %end aspect ratio
    %interpolate by taper ratio
    aol_theta = interp1(X3,Y2,Taper,'spline');

%Datcom Figure 4.1.3.1.5
%Correct for Subsonic Mach Effects
% T/C Ratio
    M2 = [0, 7, 8, 9, 10, 12, 14, 16];
% M*Cos(SweepC4)
    MX = [ 0.00,  0.10,  0.20,  0.30,  0.40,  0.45,  0.50,  0.55, ...
           0.60,  0.65,  0.70,  0.75,  0.80,  0.85,  0.90,  0.95];
% daol_M/daol_M
    MY = {[1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
           1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000]
          [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
           1.000, 1.000, 1.000, 1.000, 0.995, 0.990, 0.850, 0.700]
          [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
           1.000, 1.000, 1.000, 1.000, 0.850, 0.700, 0.000,-0.650]
          [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
           1.000, 1.000, 1.000, 0.950, 0.800, 0.000,-0.600,-3.500]
          [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
           1.000, 1.000, 1.000, 0.800, 0.250,-1.600,-3.400,-6.000]
          [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, ...
           1.000, 0.850, 0.650,-0.250,-2.000,-3.900,-7.000,-7.000]
          [1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 1.000, 0.900, ...
           0.750, 0.500 -0.100,-1.400,-3.200,-6.000,-9.000,-12.00]
          [1.000, 1.000, 1.000, 1.000, 1.000, 0.900, 0.800, 0.650, ...
           0.400,-0.150,-1.100 -2.600,-4.350,-7.350,-10.350,-13.35]};

    nmM2 = length(M2);
    Y3 = zeros(size(nmM2));
    MCS4 = M*cosd(SweepC4);
    for i=1:nmM2
        %interpolate by MCS4 for each curve
        Y3(i) = interp1(MX,MY{i},MCS4,'cubic','extrap');
    end
    aol_theta_M = interp1(M2,Y3,TC,'linear','extrap');

end